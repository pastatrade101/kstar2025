/**
 * @file Firestore Security Rules for EduPro Hub
 * @corePhilosophy This ruleset allows public read access to all collections while restricting write access.
 * @dataStructure The database consists of top-level collections for courses, instructors, news events, and admission information.
 * @keySecurityDecisions Write access to news_events is only allowed for authenticated users (admins).
 * All other collections are read-only.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows public read access to course information and restricts write access.
     * @path /courses/{courseId}
     * @allow (get, list): Any user can read course information.
     * @deny (create, update, delete): No one can create, update, or delete course information through the client.
     * @principle Public read, no writes allowed.
     */
    match /courses/{courseId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows public read access to instructor information and restricts write access.
     * @path /instructors/{instructorId}
     * @allow (get, list): Any user can read instructor information.
     * @deny (create, update, delete): No one can create, update, or delete instructor information through the client.
     * @principle Public read, no writes allowed.
     */
    match /instructors/{instructorId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }

    /**
     * @description Allows public read access to news events and restricts write access to authenticated users.
     * @path /news_events/{newsEventId}
     * @allow (get, list): Any user can read news events.
     * @allow (create): An authenticated user can create news events.
     * @allow (update, delete): An authenticated user can update or delete news events.
     * @deny (create, update, delete): A non-authenticated user cannot create, update, or delete news events.
     * @principle Public read, authenticated writes.
     */
    match /news_events/{newsEventId} {
      allow get, list: if true;
      allow create: if isSignedIn();
      allow update: if isSignedIn() && resource != null;
      allow delete: if isSignedIn() && resource != null;
    }

    /**
     * @description Allows public read access to admission information and restricts write access.
     * @path /admission_information/{admissionInformationId}
     * @allow (get, list): Any user can read admission information.
     * @deny (create, update, delete): No one can create, update, or delete admission information through the client.
     * @principle Public read, no writes allowed.
     */
    match /admission_information/{admissionInformationId} {
      allow get, list: if true;
      allow create, update, delete: if false;
    }
  }

  // Helper function to determine if a user is signed in
  function isSignedIn() {
    return request.auth != null;
  }
}